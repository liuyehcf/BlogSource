---
title: 操作系统安装
date: 2019-11-23 14:19:39
tags: 
- 原创
categories: 
- Operating System
---

__阅读更多__

<!--more-->

# 1 镜像站

## 1.1 [网易开源镜像站](http://mirrors.163.com)

以`CentOS-7.7.1908`为例，下载地址为：`http://mirrors.163.com/centos/7.7.1908/isos/x86_64/CentOS-7-x86_64-Minimal-1908.iso`

## 1.2 [centos镜像站](http://mirror.centos.org/)

以`CentOS-7.7.1908`为例，下载地址列表为：`http://isoredirect.centos.org/centos/7.7.1908/isos/x86_64/`

# 2 CentOS装机

__博主安装的是monimal版本__

1. 配网，修改`/etc/sysconfig/network-scripts/ifcfg-enp0s3`，将`ONBOOT`修改为`yes`，然后执行`systemctl restart network`
1. 安装网络工具包`yum install -y net-tools.x86_64`
1. 安装vim`yum install -y vim`

## 2.1 配置分区容量

默认情况下，CentOS会给根分区分配50G的容量，剩余容量则分配给home分区，我们可以通过一组命令简单得调整一下分区容量

__仍然保留两个分区，将大部分的容量都分配给根分区__

```sh
# 1/11: 备份home分区文件
tar cvf /tmp/home.tar /home

# 2/11: 安装 psmisc（fuser）
yum install -y psmisc

# 3/11: 杀死所有占用/home目录的进程
fuser -km /home/

# 4/11: 卸载/home文件系统
umount /home

# 5/11: 删除/home所在的lv
lvremove /dev/mapper/centos-home

# 6/11: 扩展/root所在的lv
lvextend -L +320G /dev/mapper/centos-root

# 7/11: 扩展/root文件系统
xfs_growfs /dev/mapper/centos-root

# 8/11: 创建一个1G的home LV，然后再将所有的空闲分区追加到home LV
lvcreate -L 1G -n /dev/mapper/centos-home
lvextend -l +100%FREE /dev/mapper/centos-home

# 9/11: 创建home文件系统
mkfs.xfs  /dev/mapper/centos-home

# 10/11: 挂载home文件系统
mount /dev/mapper/centos-home

# 11/11: 恢复home文件系统
tar xvf /tmp/home.tar -C /home/
cd /home/home/
mv * ../
```

__只保留根分区，/home只作为根分区的一个目录__

```sh
# 1/8: 备份home分区文件
tar cvf /tmp/home.tar /home

# 2/8: 安装 psmisc（fuser）
yum install -y psmisc

# 3/8: 杀死所有占用/home目录的进程
fuser -km /home/

# 4/8: 卸载/home文件系统
umount /home

# 5/8: 删除/home所在的lv
lvremove /dev/mapper/centos-home

# 6/8: 扩展/root所在的lv
lvextend -l +100%FREE /dev/mapper/centos-root

# 7/8: 扩展/root文件系统
xfs_growfs /dev/mapper/centos-root

# 8/8: 恢复home文件系统
tar -xvf /tmp/home.tar -C /
```

# 3 Ubuntu装机

__博主安装的是server版本__

1. 设置root密码：`sudo passwd root`
1. 网卡配置文件为`/etc/network/interfaces`（无需修改）
1. 安装openssh：`apt-get install -y openssh-server`
1. 修改ssh配置文件`/etc/ssh/sshd_config`，将`PermitRootLogin`改为`yes`，重启sshd：`service ssh restart`

# 4 制作U盘启动盘

## 4.1 MacOS

```sh
# 先列出所有设备
diskutil list

# 找到u盘对应的设备，比如这里是 /dev/disk6，卸载它
diskutil unmountDisk /dev/disk6

# 烧制ISO文件到u盘
sudo dd if=<iso文件路径> of=/dev/disk6 bs=1m

# 弹出磁盘
diskutil eject /dev/disk6
```

## 4.2 Linux

```sh
# 先列出所有设备
fdisk -l

# 找到u盘对应的设备，比如这里是 /dev/sdb，卸载它
umount /dev/sdb

# 烧制ISO文件到u盘
sudo dd if=<iso文件路径> of=/dev/sdb
```

# 5 参考

* [CentOS 7 调整 home分区 扩大 root分区](https://my.oschina.net/jasonMrliu/blog/1604954)
