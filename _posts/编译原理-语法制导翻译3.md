---
title: 编译原理-语法制导翻译3
date: 2017-11-08 10:20:20
mathjax: true
tags: 
- 摘录
categories: 
- 编译
---

__目录__

<!-- toc -->
<!--more-->

# 1 在递归的预测分析过程中进行翻译

为每个__非终结符__$A$构造一个函数，$A$的__每个继承属性__对应该函数的一个__形参__，函数的__返回值__是$A$的__综合属性值__。对出现在A产生式中的__每个文法符号__的__每个属性__都设置一个__局部变量__

__非终结符__$A$的代码根据当前的输入决定使用哪个产生式

与每个产生式有关的代码执行如下动作：从左到右考虑产生式右部的词法单元、非终结符及语义动作

* 对于带有综合属性$x$的词法单元$X$，把$x$的值保存在局部变量$X.x$中；然后产生一个匹配$X$的调用，并继续输入
* 对于非终结符$B$，产生一个右部带有函数调用的赋值语句$c := B(b_1, b_2, ..., b_k)$，其中，$b_1, b_2, ..., b_k$是代表$B$的继承属性的变量，$c$是代表$B$的综合属性的变量
* 对于每个动作，将其代码复制到语法分析器，并把对属性的引用改为对相应变量的引用

![fig1](/images/编译原理-语法制导翻译3/fig1.jpg)

![fig2](/images/编译原理-语法制导翻译3/fig2.jpg)

![fig3](/images/编译原理-语法制导翻译3/fig3.jpg)

![fig4](/images/编译原理-语法制导翻译3/fig4.jpg)

# 2 L-属性定义的自底向上翻译

给定一个以LL文法为基础的L-SDD，可以修改这个文法，并在LR语法分析过程中计算这个新文法之上的SDD

* 首先构造SDT，在各个__非终结符之前__放置语义动作来计算它的__继承属性__，并在__产生式后端__放置语义动作计算__综合属性__
* 对每个内嵌的__语义动作__，向文法中引入一个__标记非终结符__来替换它。每个这样的位置都有一个不同的标记，并且对于任意一个标记$M$都有一个产生式$M \to \varepsilon$
* 如果标记非终结符$M$在某个产生式$A \to \alpha \{ a \} \beta$中替换了语义动作$a$，对$a$进行修改得到$a^{\\'}$ ，并且将$a^{\\'}$关联到$M \to \varepsilon$上。动作$a^{\\'}$
    * 将动作$a$需要的$A$或$\alpha$中符号的任何属性作为$M$的继承属性进行复制
    * 按照$a$中的方法计算各个属性，但是将计算得到的这些属性作为$M$的综合属性

![fig5](/images/编译原理-语法制导翻译3/fig5.jpg)

## 2.1 将语义动作改写为可执行的栈操作

$$
T \to FMT^{\\'} \{ stack[top-2].val = stack[top].syn;\;top = top-2; \}
$$

* 归约后，$T$位于$top-2$的位置（弹出3个元素，压入$T$）

$$
M \to \varepsilon \{ stack[top+1]. T^{\\'}inh = stack[top].val;\;top = top+1; \}
$$

* 归约后，$M$位于$top+1$的位置（弹出0个元素，压入$M$）

$$
T^{\\'} \to * FNT_1^{\\'} \{ stack[top-3].syn = stack[top].syn;\;top = top-3; \}
$$

* 归约后$T^{\\'}$位于$top-3$的位置（弹出4个元素，压入$T^{\\'}$）

$$
N \to \varepsilon \{ stack[top+1].T^{\\'}inh = stack[top-2].T^{\\'}inh \times stack[top].val;\;top = top+1; \}
$$

* 归约后$N$位于$top+1$的位置（弹出0个元素，压入$N$）

$$
T^{\\'} \to \varepsilon \{ stack[top+1].syn = stack[top].T^{\\'}inh;\;top = top+1; \}
$$

* 归约后$T^{\\'}$位于$top+1$的位置（弹出0个元素，压入$T^{\\'}$）

$$
F \to digit \{ stack[top].val = stack[top].lexval; \}
$$

* 归约后$F$位于$top$的位置（弹出1个元素，压入$F$）

# 3 参考

__本篇博客摘录、整理自以下博文。若存在版权侵犯，请及时联系博主(邮箱：liuyehcf@163.com)，博主将在第一时间删除__

* 《MOOC-编译原理-陈鄞》
